spring:
  application:
    name: branchdown

  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  # 개발 환경: 기본값 제공 (편의성)
  datasource:
    driver-class-name: org.mariadb.jdbc.Driver
    url: jdbc:mariadb://${MARIADB_HOST:localhost}:${MARIADB_PORT:3306}/${MARIADB_DB:lex_ai}?useUnicode=true&characterEncoding=utf8mb4
    username: ${MARIADB_USERNAME:root}
    password: ${MARIADB_PASSWORD:}
    hikari:
      maximum-pool-size: ${MAX_POOL_SIZE:10}
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000  # 10분
      max-lifetime: 1800000  # 30분

  jpa:
    database-platform: org.hibernate.dialect.MariaDBDialect
    hibernate:
      ddl-auto: validate  # 개발도 validate 권장 (Flyway/Liquibase 사용 시)
    show-sql: true
    properties:
      hibernate:
        '[default_batch_fetch_size]': 100
        '[format_sql]': true
        '[use_sql_comments]': true
    open-in-view: false  # OSIV 비활성화 (성능 권장)

  data:
    jpa:
      repositories:
        bootstrap-mode: default

  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

server:
  port: ${SERVER_PORT:8083}
  shutdown: graceful
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/html,text/xml,text/plain

logging:
  level:
    root: INFO
    '[me.hanju.branchdown]': DEBUG
    '[org.hibernate.SQL]': DEBUG
    '[org.hibernate.type.descriptor.sql.BasicBinder]': TRACE
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss} - %msg%n'

# JWT Validator 설정
jwt:
  validator:
    issuer: ${JWT_ISSUER:lex-auth}
    audience: ${JWT_AUDIENCE:lex-services}
    public-key: ${JWT_PUBLIC_KEY:}

# Swagger 설정 (개발 환경 기본 활성화)
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    operations-sorter: alpha
    tags-sorter: alpha

# Actuator 설정 (개발 환경 - 모든 엔드포인트 노출)
management:
  endpoints:
    web:
      exposure:
        include: "*"  # health, info, metrics 등 모든 엔드포인트
      base-path: /actuator
  endpoint:
    health:
      show-details: always  # 상세 정보 표시
  info:
    env:
      enabled: true
